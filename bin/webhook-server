#!/usr/bin/env ruby

require 'pry'
require 'json'
require 'sinatra'

[:get, :post, :put, :patch, :delete].each do |method|
  send(method, '*') do
    begin
      body = request.body.read

      if body.empty?
        status 200
        '<html><p style="font-size:50px;text-align:center;margin-top:100px;">👋🏼</p></html>'
      else
        status 204
        parsed_json = JSON.parse(body)
        pretty_json = JSON.pretty_generate(parsed_json)
        puts cyan(pretty_json)
      end
    rescue => exception
      binding.pry
    end
  end
end

def cyan(text)
  "\n\e[36m#{text}\e[0m\n\n"
end
